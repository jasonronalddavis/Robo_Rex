; PlatformIO Project Configuration File
; Robo Rex - ESP32-S3 Hybrid Servo Control Configuration
; ESP32-S3 Freenove WROOM board
; Hybrid Mode: GPIO for channels 0-5, PCA9685 for channels 6-15 (legs)

[env:adafruit_feather_esp32s3]
platform = espressif32
board = freenove_esp32_s3_wroom
framework = arduino

; Upload settings
upload_protocol = esptool
upload_speed    = 115200
board_upload.use_1200bps_touch = no

; Serial monitor
monitor_speed = 115200

; Build flags:
; - Dual I2C bus configuration
;   * Wire (default) on GPIO 21/22 for PCA9685 at 100kHz
;   * Wire1 on GPIO 8/9 for IMU (MPU6050) at 400kHz
; - Hybrid servo control: GPIO for body, PCA9685 for legs
; - Enable optional IMU_DEBUG for detailed logging
build_flags =
  -DIMU_SENSOR_MPU6050
  -DIMU_SDA_PIN=8
  -DIMU_SCL_PIN=9
  -DIMU_DEBUG
  -DPCA9685_SDA_PIN=21
  -DPCA9685_SCL_PIN=22

; Flash settings (stable defaults)
board_build.flash_mode = dio
board_build.f_flash    = 80000000L

; Libraries
lib_deps =
  ; BLE communication
  h2zero/NimBLE-Arduino@^1.4.3

  ; JSON parsing (if needed)
  bblanchon/ArduinoJson@^6.21.3

  ; ESP32 Servo Library for direct GPIO control (channels 0-5)
  madhephaestus/ESP32Servo@^3.0.5

  ; PCA9685 PWM Servo Driver for leg servos (channels 6-15)
  adafruit/Adafruit PWM Servo Driver Library@^3.0.1

  ; IMU sensor (optional)
  adafruit/Adafruit MPU6050@^2.2.5
  adafruit/Adafruit BusIO@^1.15.0

  ; Sensor fusion (optional)
  https://github.com/arduino-libraries/MadgwickAHRS.git

  ; Base64 encoding (if needed)
  https://github.com/Xander-Electronics/Base64.git

; Hybrid Servo Configuration:
; - Channels 0-5 (Neck, Head, Pelvis, Spine, Tail): ESP32 GPIO direct control
; - Channels 6-15 (Legs - 10 servos): PCA9685 I2C PWM driver